<tool id="hicgan_predict" name="HiC-GAN Predict" version="1.0.0" profile="23.0">
    <description>Predict Hi-C contact maps using HiC-GAN</description>
    <requirements>
        <requirement type="package">hic-gan</requirement>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
        mkdir -p input_folder/
        for bw in $bigwigs; do
            cp "$bw" input_folder/
        done
        input_folder="input_folder/"
        hicPredict \
            --trainedModel "${model.path}" \
            --predictionChromatinFolders '$input_folder' \
            --predictionChromosomes "$(echo '$chromosomes' | tr ',' ' ')" \
            --matrixOutputName '$output' \
            --parameterOutputFile '$param_output' \
            -o . \
            --multiplier 2000 \
            --binSize "${model.binsize}" \
            -bs "${model.batchsize}" \
            --windowSize "${model.windowsize}"
        ]]>
    </command>
    <inputs>
        <param name="model" type="select" label="Preinstalled Model">
            <options from_data_table="hicgan_models">
                <column name="value" index="0"/>
                <column name="name"  index="1"/>
                <column name="genome" index="2"/>
                <column name="celltype" index="3"/>
                <column name="description" index="4"/>
            </options>
        </param>
        <param name="bigwigs" type="data" format="bigwig" multiple="true" label="Input Chromatin Files" help="Select one or more bigWig files as input."/>
        <param name="chromosomes" type="text" label="Prediction Chromosomes (comma-separated)" value="chr4" help="Enter chromosomes separated by commas, e.g., chr1,chr2,chr3"/>
        <!-- <param name="param_output" type="text" label="Parameter Output File" value="params.txt"/> -->

    </inputs>
    <outputs>
        <data name="output" format="cool" label="Predicted Hi-C contact map"/>
        <data name="param_output" format="txt" label="Parameter Output File"/>
    </outputs>
    <help><![CDATA[
This tool predicts Hi-C contact maps from chromatin folders using a pre-trained HiC-GAN model.

**Inputs:**
- Chromatin folder containing bigWig files.
- Select a preinstalled model.
- Chromosomes to predict.
- Output file for parameters.

**Output:**
- A .cool file containing the predicted Hi-C contact map.
- A .txt file with prediction parameters.
    ]]>
    </help>
</tool>